<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <div style="" class="topnav">
        <a href="/adminSite">Opret undervisningstime</a>
        <a class="active" href="/classSiteAdmin">Alle undervisningstimer</a>
        <li class="nav-item">
            <a class="nav-link" href="Login">Log af</a>
        </li>
    </div>
    <h1 id="h1">Undervisningstimer</h1>

    <!--Skal have henvisning så den henter "title" fra js. filen.-->
    </head>

<style>
    /* Her har vi lavet en navigationslinje/bar ved hjælp af eksemplet i denne kilde: https://www.w3schools.com/howto/howto_js_topnav.asp
    /* Add a black background color to the top navigation */
    .topnav {
        background-color: #4C4480;
        overflow: hidden;
    }

    /* Style the links inside the navigation bar */
    .topnav a {
        float: left;
        color: #f2f2f2;
        text-align: center;
        padding: 14px 16px;
        text-decoration: none;
        font-size: 17px;
    }

    .navLogOut {
        float: right !important;
    }
    /* Change the color of links on hover */
    .topnav a:hover {
        background-color: #ddd;
        color: black;
    }

    /* Add a color to the active/current link */
    .topnav a.active {
        background-color: #C43796;
        color: white;
    }
</style>

<br>

<body onload="kasper()" >
<br>
<script src="models/lesson.js"></script>
<script src="controllers/ggggg.js"></script>
<script type="text/javascript"  >
    function kasper () {
        fetch("http://localhost:3000/lessonboard").then((res) => {
            return  res.json();
        }).then((data) =>{
            var parent = document.getElementById("output");
            let array3 = []
            for(var j = 0; j< data.length; j++) {
                var div3 = document.createElement("div");
                var h1 = document.createElement("h1");
                var lessonnumber = j+1

                h1.appendChild(document.createTextNode(`Lektion Nr. ${lessonnumber} `));
                div3.appendChild(h1);
                parent.appendChild(div3);


                var div4 = document.createElement("div");
                var h1 = document.createElement("h1");
                h1.appendChild(document.createTextNode(""));
                div4.appendChild(h1);
                parent.appendChild(div4);

                let array = ["Participantnames", "_id", "Title", "Locales", "Time", "Duration", "Participants", "Teachers", "_v"];


                array3.push(data[j][array[2]])
                console.log(array3)


            for(let i = 0;i<Object.keys(data[j]).length;i++){
                if(i==1||i==8){
                    console.log("Ignore i in loop")
                } else {

                let array2 = array[i];



                // Text
                var div1 = document.createElement("div");
                var p = document.createElement("p");
                p.appendChild(document.createTextNode(Object.keys(data[j])[i]));
                div1.appendChild(p);

                // Value
                var div2 = document.createElement("div");
                var p = document.createElement("p");
                p.appendChild(document.createTextNode(data[j][array2]));
                div2.appendChild(p);

                parent.appendChild(div1);
                parent.appendChild(div2);

            } }
let id = j
                var div5 = document.createElement("div");
                var button = document.createElement("button");


                button.id = array3[j]
                button.addEventListener("click", function() {

                 let array4 = this.id
fetch('/deletelesson/'+array4,{method: 'DELETE'}).then(function(response) {
console.log(array4)
    if(response.ok){
        console.log("Click was recorded");
        return window.location.replace("/classsiteAdmin")
    }
    throw new Error('Request failed')
}).catch(function(error){
    console.log(error)
})
                })
                console.log(id)
                button.appendChild(document.createTextNode("Slet lektionen"));
                div5.appendChild(button);
                parent.appendChild(div5);


                var div6 = document.createElement("div");
                var h2 = document.createElement("h1");
                h2.appendChild(document.createTextNode(""));
                div6.appendChild(h2);
                parent.appendChild(div6);


                var div7 = document.createElement("div");
                var button2 = document.createElement("button");


                button2.id = array3[j]
                button2.addEventListener("click", function() {
                    let array8 = this.id
                    document.cookie = `lesson=${array8}`
                   window.location.replace("/changelesson")
                })
                console.log(id)
                button2.appendChild(document.createTextNode("Ændre informationer"));
                div7.appendChild(button2);
                parent.appendChild(div7);


                var div8 = document.createElement("div");
                var h3 = document.createElement("h1");
                h3.appendChild(document.createTextNode(""));
                div8.appendChild(h3);
                parent.appendChild(div8);


            }
        }).catch((e) => {
            console.log(e);
        })

    }

</script>
<div id="output" style="display:grid;grid-template-columns:auto auto;">
</div>
</body>



</html>